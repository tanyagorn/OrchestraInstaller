<!DOCTYPE html>
<html>
<head>
   <title>Database Target</title>
   <meta http-equiv="X-UA-Compatible" content="IE=edge" />
   <meta name="viewport" content="width=device-width, user-scalable=yes, initial-scale=1, minimum-scale=1" />
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="content-language" content="en-us" />
   <meta name="description" content="Description A Database Target channel is an adapter to change database contents. &nbsp;The channel &nbsp;has two basic modes: It can write a structured Message &nbsp;directly to the database" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <link id="tabscheme" type="text/css" href="hm_topic.css" rel="stylesheet" />   
<style type="text/css">
/* No header topics */

/* Breadcrumb trail */
p#breadcrumbs {
font-family: Verdana, Tahoma, Helvetica, Sans-Serif;   padding: 2px 0 1px 2px;
   margin: 0;
   font-size: 8pt; 
   color: #999;
   }   
p#breadcrumbs a { color: #999; text-decoration: none;}
p#breadcrumbs a:visited {color: #999;}
p#breadcrumbs a:hover { color: #333; border-bottom: 1px dotted #333; }

/* Search hightlight color */
span.highlight {background-color: #ffff40;}
</style>
<script type="text/javascript">
var hmHeaderTopic = true;

</script> 
<!--[if IE 9]>
<link id="iesvgcss" rel="stylesheet" type="text/css" href="hm_webhelp_svg.css" />
<![endif]-->	
<script src="jquery.js"></script>
<script type="text/javascript" src="jquery.tools.min.js"></script>
<script type="text/javascript" src="jquery.scrollTo-min.js"></script>
<script type="text/javascript"> 
// General topic variables
var tVars = {
   hmHelpPage: "index.html",
   nextP: "email-sender.html",
   prevP: "database-source-reader.html",
   currP: "database-target.html",
   descr: "Description A Database Target channel is an adapter to change database contents. &nbsp;The channel &nbsp;has two basic modes: It can write a structured Message &nbsp;directly to the database",
   keys: "",
   defP: "designer_channel_outbound.html",
   mailUrl: "",
   mailUrlQuery: "",
   projectTitle: "Documentation",
   titleP: "Database Target",
   mailsubject: "Your feedback: Documentation - Database Target",
   sharesubject: "Documentation - Database Target",
   simplesubject: "Documentation%20Feedback",
   mailid: "Database-Target",
   mailpath: "Orchestra Documentation &gt; Reference Manual &gt; Designer Reference &gt; Scenario Elements &gt; Channels &gt; Outbound &gt; Database Target /",
   mailbody: "",
   fbtype: false,
   header: true,
   background: "spacer.gif",
   tablesReady: false,
   togglesReady: false,
   webRedirect: true,
   topicTitleBar: true,
   titleBarContent: "topic",
   printFooter: true,
   zoomTip: "Click here to view image in its original size",
   autoPrint: true,
   printButton: "Print",
   printButtonTip: "Print topic"
   }
// Popup configuration
 var hmpBShadow = true;
 var hmPopSmallDim = 500;
 var hmPopKillVideo = true;
 // AutoTOC variables
 var hmatocvars = {
   atoc_show: true,
   atoc_title: "Topic content",
   atoc_tip: "Navigate to:&nbsp;",
   atoc_minHeaders: 3,
   atoc_btntip_off: "No topiv headers on this site",
   atoc_btntip_on: "Show/hide topic menu",
   atoc_toptip: "Navigate to beginning of page",
   atoc_top: "Beginning of page",
   atoc_bg: "#f6f6f6",
   atoc_border: "silver",
   atoc_linkcolor: "#444",
   atoc_linklimit: 45,
   atoc_hovercolor: "#000",
   atoc_hoverbgcolor: "#e0e0e0"
}
// Sortable tables
var sortVars = {
   europeandate: false,
   germanNumbers: false,
   imagePath: "",
   image_up: "arrow-up.gif",
   image_down: "arrow-down.gif",
   image_empty: "arrow-empty.gif",
   image_none: "arrow-none.gif",
   sort_tip: "Click here to sort column",
   umlauts: "false"
   }

</script>


<script type="text/javascript" src="helpman_settings.js"></script>
<script type="text/javascript" src="helpman_topicinit.js"></script>
<script type="text/javascript" src="hmtopic.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "database-target.html");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body>
<!-- Help & Manual Premium Pack templates by Tim Green, Copyright (c) 2011-2014, All Rights Reserved -->
<!--ZOOMSTOP-->



<ul id="topictabs" class="tabs">
<li id="indextab" class="hmtabs"><a href="#" id="indextablink" class="current"><span>Database Target</span></a></li>
</ul>
<div id="hmbox">
<div id="hmheader">
<div id="hmheadercontents">
<p id="breadcrumbs" class="sync-toc">
<b><span class="sync-toc"><a rel="nofollow" class="sync-toc-link" href="index.html?database-target.html" target="_top">&lt;&lt;&nbsp;Click here for table of contents&nbsp;&gt;&gt;</a>&nbsp;&nbsp;</span></b></p> 
<h1 class="p_Heading1"><span class="f_Heading1">Database Target</span></h1>

</div>
<div id="atocIcon" class="navdivs">
<img class="navicon" id="hmAtocLink" src="contents_off.png" alt="No topiv headers on this site" title="No topiv headers on this site" />
<br /><span>Topic content</span>
</div>
</div>
<div id="autoTocWrapper" class="topicmenu"></div>
<div id="idcontent">
<div id="unclicker"></div>
<!--ZOOMRESTART-->
<p class="p_Normal">&nbsp;</p>
<h2 class="p_Heading2"><span class="f_Heading2">Description</span></h2>
<p class="p_Normal">A <span class="f_Emphasize">Database Target channel</span> is an adapter to change database contents. </p>
<p class="p_Normal">The channel &nbsp;has two basic modes:</p>
<p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_BulletedListNormal">It can write a structured <a href="designer_glossary_message.html" class="topiclink">Message</a> &nbsp;directly to the database, where each complex element of the message represents a record to be written to the database.</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_BulletedListNormal">It can implicitly perform a <a href="designer_mapping_graphical.html" class="topiclink">Orchestra mapping</a> during its execution, whose result elements are written directly into the database while the result is created.</span></p><div style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 10px;"><table class="warningattentioninfo table" style="border:none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:37px; padding:0px;"><p class="p_Normal"><img alt="alert-info-ico" width="24" height="24" style="margin:0;width:24px;height:24px;border:none" src="alert-info-ico.png"/></p>
</td>
<td style="vertical-align:top; width:1131px; padding:0px;"><p class="p_Info"><span class="f_Info">Note: The target data type must be imported directly from a Database Dictionary or from a Valuemation repository! &nbsp;Otherwise the channel doesn't know the names of the target tables and columns.</span><br />
<span class="f_Info">For more detailed information about message types please refer to <a href="message-types.html" class="topiclink">Message types</a>. Here you also find detail about how to import message types from a <a href="messagetypes_creation.html#designer_msg_type_import_from_db" class="topiclink">Database</a> or from <a href="messagetypes_creation.html#designer_msg_type_import_from_vm" class="topiclink">Valuemation</a>.</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Subheading"><span class="f_Subheading">A simple example</span></p>
<p class="p_Normal">Assume we have two database tables containing information about invoices. First we have a table INV_HEAD representing the invoice and a table INV_DETAIL representing an invoice item. If we import the two tables as a message type from the database it looks like:</p>
<div class="p_Normal"><div style="margin:0;width:697px"><img alt="Message type &nbsp;imported from a database" title="Message type &nbsp;imported from a database" width="697" height="344" style="width:697px;height:344px;border:none" src="designer_msg_type_import_from_db_result.png"/><p style="text-align:center"><span class="f_ImageCaption">Message type &nbsp;imported from a database</span></p></div></div>
<p class="p_Normal">As you can see, the message type contains additional information, like the columnname. This information is used from the <span class="f_Emphasize">Database Target channel</span> to create SQL statements.</p>
<p class="p_Normal">If you <a href="database-target.html#designer_channel_db_target_configuration" class="topiclink">configure</a> the <span class="f_Emphasize">Database Target channel</span> with this type it looks like:</p>
<p class="p_Normal"><img alt="designer_channel_db_target_invoice_example" width="909" height="481" style="margin:0;width:909px;height:481px;border:none" src="designer_channel_db_target_invoice_example.png"/></p>
<p class="p_Normal">If the channel is invoked with a message of the given type, it traverses the elements of the message and for each <span class="f_Emphasize">invoice</span> it encounters, a record is written to the database table INV_HEAD and for each <span class="f_Emphasize">invoice item</span> it encounters, a record is written to the table INV_DETAIL. Actually the name of the table is contained in the message type as annotation <span class="f_Emphasize">tablename</span> assigned to the record elements and the names of all columns are added as annotation <span class="f_Emphasize">columnname</span> to each simple attribute. These annotations are added to the message type when it is imported from the database or from <span class="f_Emphasize">Valuemation</span>.</p>
<p class="p_Normal">A data record can be written to the database in several <a href="database-target.html#designer_channel_db_target_modes" class="topiclink">modes</a>. For example a record can simply be added to the database table executing an insert statement. In the example above the table INV_HEAD is selected. On the right you see that for this table the mode <span class="f_buttonslabelsetc">Replicate</span> is selected. For every table the user can select a different mode. <span class="f_buttonslabelsetc">Replicate </span>means that the record is updated if it exists and inserted into the table if it doesn't exist. to find out if the record exists, the channel either executes an update statement or a select statement. In both cases it needs a key definition to create an appropriate where condition. You have to select such a key in the <span style="font-style: italic;">key field</span> under the type tree. If you click on the button with the <span style="font-style: italic;">key symbol</span> a dialog appears showing the columns of the selected key.</p>
<p class="p_Normal">Before and after a record is written to the database a script can be executed. For example you may select additional information or change some other tables procedurally. For Details see <a href="database-target.html#designer_channel_db_target_trigger_scripts" class="topiclink">Trigger scripts</a> .</p>
<p class="p_Subheading"><a id="designer_channel_db_target_modes" class="hmanchor"></a><span class="f_Subheading">Working modes</span></p>
<p class="p_Normal">A data record can be written to the database in several modes:</p>
<p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">Replicate</span><span class="f_BulletedListNormal"> Insert the record or update it, if it already exists. The channel uses two strategies to find out if a record exists:</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 39px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#9642;</span><span class="f_BulletedListNormal">First update the record and if the update affects no table then perform an insert</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 39px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#9642;</span><span class="f_BulletedListNormal">Select the record, if it is not found perform an insert statement otherwise update the record.</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">Insert</span><span class="f_BulletedListNormal"> Insert a record by executing an insert statement</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">Update</span><span class="f_BulletedListNormal"> Update a record by executing an update statement</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">Insert New</span><span class="f_BulletedListNormal"> Insert a record if it does not exist</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">Replicate Changes</span><span class="f_BulletedListNormal"> Insert or update data if values have changed</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">Update Changes</span><span class="f_BulletedListNormal"> Update data if values have changed</span></p><p class="p_Normal">&nbsp;</p>
<div style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 23px;"><table class="warningattentioninfo table" style="border:none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:37px; padding:0px;"><p class="p_Normal" style="margin: 0px 0px 0px 23px;"><img alt="alert-error-ico" width="24" height="24" style="margin:0;width:24px;height:24px;border:none" src="alert-error-ico.png"/></p>
</td>
<td style="vertical-align:top; width:1131px; padding:0px;"><p class="p_Warning" style="margin: 0px 0px 0px 23px;"><span class="f_Warning">Attention: All modes but the Insert mode, require necessarily a key on the database table. If no key is defined and selected for the table mapping, executing the channel will cause an error, because the channel doesn't know how to identify a record.</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Subheading"><span class="f_Subheading">Valuemation specific modes</span></p>
<p class="p_Normal">The modes <span class="f_Emphasize">Replicate changes</span><span style="font-size: 16px; background-color: #ffffff;">&nbsp;and&nbsp;</span><span class="f_Emphasize">Update changes</span><span style="font-size: 16px; background-color: #ffffff;">&nbsp;are specific for&nbsp;</span><span class="f_Emphasize">Valuemation</span><span style="font-size: 16px; background-color: #ffffff;">&nbsp;databases. If one of these strategies is selected and in&nbsp;</span><span class="f_Emphasize">Valuemation</span><span style="font-size: 16px; background-color: #ffffff;">&nbsp;for the target table the property&nbsp;</span><span class="f_Emphasize">Enable audit</span><span style="font-size: 16px; background-color: #ffffff;">&nbsp;is enabled, then changed values are logged into the according tables&nbsp;</span><span class="f_Emphasize">AMT_AUDITEDCHG&lt;bankid&gt;</span><span style="font-size: 16px; background-color: #ffffff;">. Changes will be logged only for those columns for which&nbsp;</span><span class="f_Emphasize">Enable audit </span><span style="font-size: 16px; background-color: #ffffff;">is enabled. So logging of changed values is in effect if&nbsp;</span><span class="f_Emphasize">Enable audit is</span><span style="font-size: 16px; background-color: #ffffff;">&nbsp;set for the target table and the required columns.</span></p>
<p class="p_Normal"><span style="font-size: 16px; background-color: #ffffff;">Another benefit of using these modes is, that updates are only executed, if actually changed data are delivered from the data source. Therefore the table columns USERCHG and DATCHG are changed only if &nbsp;the record was actually changed. To check if data were changed, the channel has to read all row data from the table. Therefore this mode costs more performance than a simple&nbsp;</span><span class="f_Emphasize">Replicate</span><span style="font-size: 16px; background-color: #ffffff;">&nbsp;or&nbsp;</span><span class="f_Emphasize">Update</span><span style="font-size: 16px; background-color: #ffffff;">.</span></p>
<p class="p_Subheading"><a id="designer_channel_db_target_trigger_scripts" class="hmanchor"></a><span class="f_Subheading">Trigger scripts</span></p>
<p class="p_Normal">In the DB-Target Channel, a specially designed <a href="database-target.html#designer_channel_db_target_scripting_language" class="topiclink">scripting language</a> for this channel is used. This language is used to define procedures which are executed at certain points while the channel writes data to the database. These procedures are called trigger procedures. There are three types of triggers:</p>
<p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">Before change</span><span class="f_BulletedListNormal"> Executed before a record is written to the database. Also for the root node a before changed trigger may be defined. it is executed once at the beginning of the channel invocation.</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">After enter</span><span class="f_BulletedListNormal"> Executed after a record is written to the database but before any dependent records have been written to the database.</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">Before leave</span><span class="f_BulletedListNormal"> Executed after a record and all its dependent records have been written to the database.</span></p><p class="p_Subheading"><span class="f_Subheading">Operation Order</span></p>
<p class="p_Normal">In the course of writing data records to the database, the DBTarget channel performs a sequence of actions in the following order:</p>
<p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:13px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span>The Before change trigger will be executed (if available). The trigger can refer to all mapped attributes using the syntax <span class="f_CodeExample">$(attributname)</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:13px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span>A select on a target table will be performed, if the mapping mode is Replicate, Insert new, Replicate changes or Update changes.</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:13px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span>The Attribute Expressions will be evaluated and their values will be assigned to the related attributes. The expressions have access to the mapped attributes as well as to all variables that were set from the Before trigger.</p><div style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 10px;"><table class="warningattentioninfo table" style="border:none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:37px; padding:0px;"><p class="p_Normal"><img alt="alert-info-ico" width="24" height="24" style="margin:0;width:24px;height:24px;border:none" src="alert-info-ico.png"/></p>
</td>
<td style="vertical-align:top; width:1131px; padding:0px;"><p class="p_Info"><span class="f_Info">Note: Attribute expressions will be evaluated only if the target variable has not yet a value. </span><br />
<span class="f_Info">If the target column is marked as insertOnly in the message type, the expression is only evaluated if the target record doesn't exist. That means also, that in Replicate mode the insert only expressions are postponed until the channel knows that the record doesn't exists (that is after the update statement returns 0)</span></p>
</td>
</tr>
</table>
</div>
<p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span>The generated insert or update statements on the target table will be executed.</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span>The After enter trigger will be executed (if available).</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span>child records will be written to the database, recursively invoking this sequence of actions.</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span>The Before leave trigger will be executed (if available).</p><h2 class="p_Heading2"><span class="f_Heading2">Creation</span></h2>
<p class="p_Normal">To create a <span class="f_Emphasize">Database target channel</span> follow the steps described in the general description of <a href="channels.html#create_new_channel" class="topiclink" title="how to create a new channel">Channels</a>.</p>
<h2 class="p_Heading2"><a id="designer_channel_db_target_configuration" class="hmanchor"></a><span class="f_Heading2">Configuration</span></h2>
<p class="p_Normal">The dialog to configure the <span class="f_Emphasize">Database target channel</span> looks like:</p>
<div class="p_ImageCaption"><div style="margin:0;width:925px"><img alt="Example of a database target channel" title="Example of a database target channel" width="925" height="473" style="width:925px;height:473px;border:none" src="designer_channel_db_target_config.png"/><p style="text-align:center"><span class="f_ImageCaption">Example of a database target channel</span></p></div></div>
<h2 class="p_Heading2"><span class="f_Heading2">Step by Step</span></h2>
<p class="p_Normal">The following section explains the properties which are valid for the whole channel.</p>
<p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">Database</span> - Select the appropriate database connection.The database connection has to be created as environment entry (<a href="database-connection.html" class="topiclink">database connection</a>).</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">Mapping</span><span class="f_BulletedListNormal"> - Select the desired database mapping. You actually don't need to select a mapping. If a mapping is selected, the message given to the channel must match the source type of the mapping. If no mapping is selected, the message must match the selected target type.</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">Target type</span><span class="f_BulletedListNormal"> - Message type created by importing it from the Database. If a mapping was selected it always is the target type of the mapping. Actually in this case this element is not editable.</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">Type of key generation</span><span class="f_BulletedListNormal"> - The strategy the function newID (see <a href="database-target.html#designer_channel_db_target_trigger_functions" class="topiclink">Functions</a>) has to use when creating a new key. The following values are supported:</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 39px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#9642;</span><span class="f_BulletedListNormal">OracleSequence - Only available for Oracle databases. In the target database schema, a sequence with the name &nbsp;ORCH_SEQUENCE must exist. The next value of the sequence will be used</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 39px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#9642;</span><span class="f_BulletedListNormal">MaxId - The key is generated by taking the maximum value of the column of all records in the table and adding one to it.</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 39px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#9642;</span><span class="f_BulletedListNormal">VMHighestKey - Key generated in the same way as </span><span class="f_Emphasize">Valuemation</span><span class="f_BulletedListNormal">. </span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">More parameters</span><span class="f_BulletedListNormal"> Click on this button to open a panel where...</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">Has result</span><span class="f_BulletedListNormal"> - Indicates if the channel has result message. The result message resembles the data written to the database. It also contains additional information.</span><br />
<span class="f_BulletedListNormal">Specifically key attributes are annotated with the XML attribute </span><span class="f_Emphasize">isKey</span><span class="f_BulletedListNormal">, error message from the database are added to the the message (if the RESULT status of the channel invocation is errors), information set by executing RESULTMSG.&lt;category&gt; (see <a href="database-target.html#designer_channel_db_target_resultmsg" class="topiclink">RESULTMSG</a>) are also added to the result message.</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">Max error count</span><span class="f_BulletedListNormal"> - If the number of errors set by the statement  <a href="database-target.html#designer_channel_db_target_resultmsg" class="topiclink">RESULTMSG</a> is higher than this value, the channel invocation fails with RESULT status errors.</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">Write NULL Values</span><span class="f_BulletedListNormal"> If this option is set...</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">Use batch mode</span><span class="f_BulletedListNormal"> - Try to use database batch mode to increase performance. The benefit of this method is highly database dependent. The property is selectable only if the channel has no result and the type of key generation is not </span><span class="f_Emphasize">MaxId. </span><span class="f_BulletedListNormal">Also this mode is only sensible if there are no select statements interfering the insert or update statements because otherwise no batch of statements can be created and the batch mode will not increase the performance.</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_BulletedListNormal">In batch mode normally the default batch size is 100. Actually the value is taken from the the parameter </span><span class="f_BulletedListNormal" style="font-style: italic;">adapter.dbtarget.max.batch.count</span><span class="f_BulletedListNormal"> from the Orchestra <a href="monitor_managing-environment-settings.html" class="topiclink">environment settings</a>, so it might be different in Orchestra designer and in the Orchestra runtime. If the user has a developer key the maximal batch size is configurable if you deselect the check box </span><span class="f_Bulletedtopiclist">Use default batch size</span><span class="f_BulletedListNormal">. </span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_BulletedListNormal">In the </span><span class="f_BulletedListNormal" style="font-style: italic;">key field</span><span class="f_BulletedListNormal"> </span> under the type tree you must select a key for the the selected target table. Only in <span style="font-style: italic;">insert</span> mode you don't need a target key, all other nodes need a key to create an appropriate where part for the update or select statements necessary to write the data to the correct record on the database table. &nbsp;If you click on the button with the <span style="font-style: italic;">key symbol</span> a dialog appears showing the columns of the selected key. If a mapping is selected in the select box labeled <span class="f_buttonslabelsetc">Mapping</span> you can select the check box <span class="f_buttonslabelsetc">prefer mapping keys</span>. If selected the channel prefers the key configured in the according node mapping of the orchestra mapping. In rare cases this may be sensible because two node mappings might refer to the same target node but both define different target keys.</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_BulletedListNormal">If the toggle button with the label </span><span class="f_buttonslabelsetc">Show &nbsp;all attributes</span><span class="f_BulletedListNormal"> is selected all attributes of the target message type are shown. If it is not selected only the key fields and the fields having an expression assigned are shown.</span></p><p class="p_Subheading"><a id="designer_channel_db_target_edit_table_mappings" class="hmanchor"></a><span class="f_Subheading">Editing table mappings</span></p>
<p class="p_Normal">The relationship between a message element and a database table is called a table mapping. If you select a table element in the tree on left of the channel editor you can change the properties of the related table mapping:</p>
<p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">Mode</span><span class="f_BulletedListNormal"> - Write mode of the table mapping. </span>See paragraph <a href="database-target.html#designer_channel_db_target_modes" class="topiclink">Working modes</a> &nbsp;for details.</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">Before change </span><span class="f_BulletedListNormal">trigger, </span><span class="f_Bulletedtopiclist">After enter </span><span class="f_BulletedListNormal">trigger and </span><span class="f_Bulletedtopiclist">Before leave </span><span class="f_BulletedListNormal">trigger. See <a href="database-target.html#designer_channel_db_target_trigger_scripts" class="topiclink">Trigger scripts</a> &nbsp;for details</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">Elements of the target data type</span><span class="f_BulletedListNormal"> - These corresponds with the tables and the columns of the target database into which the data is written.</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">Target key</span><span class="f_BulletedListNormal"> - Unique identifier of the selected Database Table. </span></p><h2 class="p_Heading2"><a id="designer_channel_db_target_scripting_language" class="hmanchor"></a><span class="f_Heading2">Scripting language</span></h2>
<p class="p_Normal">In the DB-Target Channel, a specially designed scripting language for this channel is used. This language is used to define the <span class="f_BulletedListNormal"> <a href="database-target.html#designer_channel_db_target_trigger_scripts" class="topiclink">Trigger scripts</a></span> which are executed at certain points while the channel writes data to the database.</p>
<p class="p_Subheading"><span class="f_Subheading">Language elements</span></p>
<p class="p_Normal">In the following sub chapter, we provide an overview of the language elements in the <span class="f_Emphasize">Database target channel</span>. The Syntax of the language is given in EBNF.</p>
<p class="p_Subheading2"><span class="f_Subheading2">Attribute Expressions</span></p>
<p class="p_Normal">Expressions compute a value which can be assigned to variables or can be used to compose more complex expressions.</p>
<p class="p_Normal">Examples:</p>
<p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 39px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#9642;</span><span class="f_CodeExample">1 + $(count)</span> an add expression. The value of the variable <span class="f_Emphasize">count</span> must be numeric</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 39px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#9642;</span><span class="f_CodeExample">'error occurred: ' + $(name)</span> a string concatenation. The value of the variable <span class="f_Emphasize">name</span> is translated to a string</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 39px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#9642;</span><span class="f_CodeExample">substring((select TYPE from INVOICE where INV_NUM = $(inv_id)), 3)</span> a function call having a select expression and a literal number as parameters.</p><p class="p_Normal">The formal syntax is described in the following lines:</p>
<p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_buttonslabelsetc">Expression</span> ::= AddExpression { &quot;or&quot; AddExpression }</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_buttonslabelsetc">AddExpression</span> ::= StringConcatenation | NumericExpression</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_buttonslabelsetc">StringConcatenation</span> ::= PrimaryExpression &quot;+&quot; AddExpression</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_buttonslabelsetc">NumericExpression</span> ::= MultiplyExpression { &quot;+&quot; MultiplyExpression } | MultiplyExpression &quot;-&quot; MultiplyExpression</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_buttonslabelsetc">MultiplyExpression</span> ::= PrimaryExpression { &quot;*&quot; PrimaryExpression }</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_buttonslabelsetc">PrimaryExpression</span> ::= &quot;(&quot; Expression &quot;)&quot; | Literal | VariableExpression | FunctionCall | SelectExpression</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_buttonslabelsetc">VariableExpression</span> ::= &quot;$(&quot; Varname &quot;)&quot; | &quot;$(&quot; &quot;../&quot; Varname &quot;)&quot; | &quot;$(&quot;&quot;/&quot; Varname&quot;)&quot;</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_buttonslabelsetc">FunctionCall</span> ::= Name &quot;(&quot; [ Expression { &quot;,&quot; Expression } ] &quot;)&quot;</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_buttonslabelsetc">SelectExpression</span> ::= &quot;select&quot; SQLRest</p><p class="p_Subheading2"><span class="f_Subheading2">Values</span></p>
<p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_buttonslabelsetc">Literal</span> ::= NumericLiteral|StringLiteral|BooleanLiteral|&quot;null&quot;|&quot;NULL&quot;</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_buttonslabelsetc">NumericLiteral</span> ::= Digits [ &quot;.&quot; Digits]</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_buttonslabelsetc">StringLiteral</span> ::= &quot;'&quot; char ... &quot;'&quot;</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_buttonslabelsetc">BooleanLiteral</span> ::= &quot;true&quot; | &quot;false&quot; | &quot;TRUE&quot; | &quot;FALSE&quot;</p><p class="p_Subheading2"><span class="f_Subheading2">Global variables</span></p>
<p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span>$(/dbSchemaname)</p><p class="p_Subheading2"><a id="designer_channel_db_target_trigger_functions" class="hmanchor"></a><span class="f_Subheading2">Functions</span></p>
<p class="p_Normal">The language has some helpful build in functions:</p>
<p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">dateTime now () </span><span class="f_BulletedListNormal">returns the current java.sql.Timestamp</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">date today () </span><span class="f_BulletedListNormal">returns the date of the current day (internally java.sql.Date)</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">date yesterday () </span><span class="f_BulletedListNormal">returns the date before the current day (internally of type java.sql.Date)</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">date toDate (string stringDate, string dateFormat)</span></p><p class="p_Normal" style="margin: 0px 0px 0px 23px;">Default for dateFormat is 'dd.MM.yyyy'</p>
<p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">date dayBefore (date date, int days?)</span></p><p class="p_Normal" style="margin: 0px 0px 0px 23px;">Default for days is 1</p>
<p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">string substring (string str, int startIndex, int length?)  </span><span class="f_BulletedListNormal">returns the string starting at </span><span class="f_BulletedListNormal" style="font-style: italic;">startIndex</span><span class="f_BulletedListNormal"> with the given length. The parameter length is optional; if missing the</span> value for length is is set to 256.</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">int newID (string tablename, string columnname)</span><span class="f_BulletedListNormal"> create a new unique numeric key for the given table column. The function uses the strategy selected through the respective combo box.</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">string newKey (string client, string boname, string attrname)</span><span class="f_BulletedListNormal"> create a unique element name. Only usable with a </span><span class="f_Emphasize">Valuemation</span><span class="f_BulletedListNormal"> database.</span><br />
<span class="f_BulletedListNormal">Example : </span><span class="f_CodeExample">newKey ($(client), 'Item', 'item')</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">int strlen(string str)</span><span class="f_BulletedListNormal"> get the length of the string</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">string timeToString(time tim, string pattern)</span><span class="f_BulletedListNormal"> format the time according to a string pattern</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">string dateToString(date dat, string pattern)</span><span class="f_BulletedListNormal"> format the date according to a string pattern</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_Bulletedtopiclist">string stringToCLOB(string str)</span><span class="f_BulletedListNormal"> mark a string as to be written as CLOB to the database.</span></p><p class="p_Subheading2"><span class="f_Subheading2">Trigger</span></p>
<p class="p_Normal">A script is represented by the element <span class="f_Emphasize">Trigger</span> which actually is a sequence of statements:</p>
<p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span>Trigger ::= Block</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span>Block ::= Statement { &quot;;&quot; Statement }</p><p class="p_Subheading2"><span class="f_Subheading2">Statements</span></p>
<p class="p_Normal">Statements execute some action. Typically they set the value of variables or write data to the database.</p>
<p class="p_Normal">Examples:</p>
<p class="p_Normal">First we show a simple assignment of a select expression to a variable</p>
<p class="p_Normal" style="margin: 0px 0px 0px 23px;"> <span class="f_CodeExample">$(count) = select count(*) from INVOICE where INV_TYPE = 1;</span></p>
<p class="p_Normal">We also can store more than one value in a variable using a select into statement:</p>
<p class="p_Normal" style="margin: 0px 0px 0px 23px;"> <span class="f_CodeExample">$(count) = select INV_TYPE, CREDAT into $(inv_type), $(credat) from INVOICE where INV_NUM = $(inv_id);</span></p>
<p class="p_Normal">The following example shows a condition statement which contains a Result Operation statement.</p>
<p class="p_Normal" style="margin: 0px 0px 0px 23px;"> <span class="f_CodeExample">if not exists INVOICE where INV_NUM = $(inv_id) then RESULTMSG.warning invoicdId 'nod invoice found for ' + $(inv_id) end</span></p>
<p class="p_Normal">For more complex examples see <a href="database-target.html#designer_channel_db_target_scripting_language" class="topiclink">More examples for trigger scripts</a>.</p>
<p class="p_Normal">The formal syntax is described in the following lines:</p>
<p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_buttonslabelsetc">Statement</span> ::= IfStatement | Assignment | SelectIntoStatement | CountLoop | SelectLoop | SQLStatement | CancelStatement | RollbackStatement | ResultOperation </p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_buttonslabelsetc">IfStatement</span> ::= &quot;if&quot; Condition &quot;then&quot; Block [ &quot;else&quot; Block ] &quot;end&quot;</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_buttonslabelsetc">Assignment</span> ::= VariableRef &quot;=&quot; Expression</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_buttonslabelsetc">VariableRef</span> ::= &quot;$(&quot; Varname &quot;)&quot;</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_buttonslabelsetc">SelectIntoStatement</span> ::= &quot;select&quot; SQL-Expressionlist &quot;into&quot; VariableRef { &quot;,&quot; VariableRef } &quot;from&quot; Tablename [ &quot;where&quot; SQLRest ]</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_buttonslabelsetc">CountLoop</span> ::= &quot;for&quot; VariableRef &quot;from&quot; Expression “to” Expression “do” Block “end”</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_buttonslabelsetc">SelectLoop</span> ::= “loop” &quot;select&quot; SQL-Expressionlist &quot;into&quot; VariableRef { &quot;,&quot; VariableRef } “from” SQLRest “do” Block “end”</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_buttonslabelsetc">Tablename</span> ::= Name [ &quot;.&quot; Name ]</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_buttonslabelsetc">CancelStatement</span> ::= &quot;cancel&quot; &quot;operation&quot;</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_buttonslabelsetc">RollbackStatement</span> ::= &quot;rollback&quot; &quot;transaction&quot;</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_buttonslabelsetc">ResultOperation</span> ::= &quot;RESULTMSG&quot; &quot;.&quot; ( &quot;failure&quot; | &quot;error&quot; | &quot;warning&quot; | &quot;info&quot; ) [ Name ] AddExpression</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_buttonslabelsetc">SQLStatement</span> ::= ( &quot;update&quot; | &quot;insert&quot; | &quot;delete&quot; ) SQLRest</p><p class="p_Subheading2"><span class="f_Subheading2">Conditions</span></p>
<p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_buttonslabelsetc">Condition</span> ::= AndCondition { &quot;or&quot; AndCondition }</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_buttonslabelsetc">AndCondition</span> ::= PrimaryCondition { &quot;and&quot; PrimaryCondition }</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_buttonslabelsetc">PrimaryCondition</span> ::= &quot;(&quot; Condition &quot;)&quot; | &quot;not&quot; Condition | ExistsCondition | EqualCondition | CompareCondition | &quot;is&quot; &quot;canceled&quot;</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_buttonslabelsetc">ExistsCondition</span> ::= &quot;exists&quot; Tablename &quot;where&quot; SQLRest</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_buttonslabelsetc">EqualCondition</span> ::= AddExpression ( &quot;=&quot; | &quot;!=&quot; | &quot;&lt;&gt;&quot; ) AddExpression</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_buttonslabelsetc">CompareCondition</span> ::= NumericExpression ( &quot;&lt;&quot; | &quot;&lt;=&quot; | &quot;&gt;&quot; | &quot;&gt;=&quot; ) NumericExpression</p><p class="p_Subheading2"><span class="f_Subheading2">Comments</span></p>
<p class="p_Normal">Comments are specified as in Java:</p>
<p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span>line comments starts with <span class="f_buttonslabelsetc">//</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span>multi-line comments enclosed with <span class="f_buttonslabelsetc">/* */</span></p><p class="p_Subheading2"><a id="designer_channel_db_target_resultmsg" class="hmanchor"></a><span class="f_Subheading2">Statements RESULTMSG, cancel operation and rollback transaction</span></p>
<p class="p_Normal">The statement <span class="f_buttonslabelsetc">RESULTMSG.&lt;category&gt; [&lt;childname&gt;] &lt;expr&gt;</span> adds information in the return message and affects the output-parameter <span class="f_buttonslabelsetc">RESULTSTATE</span> of the channel call.</p>
<p class="p_Normal"><span class="f_buttonslabelsetc">&lt;category&gt;</span> may have the &nbsp;values <span class="f_Emphasize">failure</span>, <span class="f_Emphasize">error</span>, <span class="f_Emphasize">warning</span> or <span class="f_Emphasize">info</span></p>
<p class="p_Normal">The return parameter <span class="f_Emphasize">RESULTSTATE</span> of the call returns the highest error value that was set during execution. If for example during the execution of the channel <span class="f_buttonslabelsetc">RESULTMSG.error</span> and <span class="f_buttonslabelsetc">RESULTMSG.warning</span> are called, then the <span class="f_Emphasize">RESULTSTATE</span> of the channel invocation gets the value <span class="f_Emphasize">errors</span>.</p>
<p class="p_Normal"><span class="f_Emphasize">RESULTSTATE</span> can get the values <span class="f_Emphasize">failed</span>, <span class="f_Emphasize">errors</span>, <span class="f_Emphasize">warnings</span> or <span class="f_Emphasize">success.</span></p>
<p class="p_Normal"><span class="f_buttonslabelsetc">RESULTMSG</span> writes the value of the expression in the output message as follows:</p>
<p class="p_Normal">If the <span class="f_Emphasize">childname</span> is given, then the<span class="f_buttonslabelsetc"> &lt;category&gt;</span> is appended as an XML attribute to the corresponding child element of the current node of the result message.</p>
<p class="p_Normal">For example the statement <span class="f_CodeExample">RESULTMSG.error size, 'invalid length'</span> adds an XML attribute <span class="f_CodeExample">error</span> to the element <span class="f_CodeExample">&lt;size&gt;</span> . This might look like <span class="f_CodeExample">&lt;size error=&quot;invalid length&quot;&gt;0&lt;/size&gt;</span>.</p>
<div style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 10px;"><table class="warningattentioninfo table" style="border:none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:37px; padding:0px;"><p class="p_Normal"><img alt="alert-info-ico" width="24" height="24" style="margin:0;width:24px;height:24px;border:none" src="alert-info-ico.png"/></p>
</td>
<td style="vertical-align:top; width:1131px; padding:0px;"><p class="p_Info"><span class="f_Info">Attention: The parameter childname is only allowed in a Before Trigger.</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Normal">If <span class="f_Emphasize">childname</span> is not given, a child element named like the <span class="f_Emphasize">category</span> and the value of the expression is added to the current target node.</p>
<p class="p_Normal">For example the statement <span class="f_CodeExample">RESULTMSG.warning 'invalid value'</span> adds an element <span class="f_CodeExample">&lt;warning&gt;invalid value&lt;/warning&gt;</span> to the current node of the result message.</p>
<p class="p_Normal">The best way to see this is to &nbsp;create a channel and view the result message.</p>
<p class="p_Normal"><span class="f_buttonslabelsetc">RESULTMSG.error</span> implicitly calls <span class="f_Emphasize">cancel operation</span>.</p>
<p class="p_Normal">Note that the channel will continue to execute &nbsp;database operations for subsequent nodes of the source message but not for child records of the current node.</p>
<p class="p_Normal"><span class="f_buttonslabelsetc">RESULTMSG.failure</span>, like the statement <span class="f_Emphasize">rollback transaction</span>, sets &nbsp;the RESULTSTATE to <span class="f_Emphasize">failed</span> and executes a rollback of the whole database transaction.</p>
<p class="p_Normal"><span class="f_buttonslabelsetc">RESULTMSG.failure</span> additionally sets in the channel state the <span class="f_buttonslabelsetc">AdapterDetail: ( &quot;ERROR&quot;, &quot;Last error&quot;, &lt;errortext&gt;)</span> and increases the error counter <span class="f_buttonslabelsetc">(AdapterDetail: &quot;Info&quot;, &quot;Errors&quot;, &lt;errorcount&gt; )  </span>And of course (like always in <span class="f_buttonslabelsetc">RESULTMSG</span>) an information text is added to the result message.</p>
<p class="p_Normal">If the statement <span class="f_buttonslabelsetc">cancel operation</span> is called, then a flag is set to ensures that:</p>
<p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_BulletedListNormal">No further scripts (after enter, leave before) are executed for this node and its child nodes. All subsequent statements within the script will still run!</span></p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_BulletedListNormal">No database operations for this node and its child nodes are executed.</span></p><p class="p_Normal">The statement <span class="f_buttonslabelsetc">rollback transaction</span> executes a rollback on the target database.</p>
<p class="p_Subheading2"><a id="designer_channel_db_target_example_scripts" class="hmanchor"></a><span class="f_Subheading2">More examples for trigger scripts</span></p>
<p class="p_Normal">Here we show some more complex examples of trigger scripts:</p>
<div style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 10px;"><table style="border:none; border-spacing:1px;">
<thead>
<tr style="text-align:left;vertical-align:top;">
<th style="vertical-align:top; width:729px; height:14px; background-color:#0062a2; padding:6px; border:solid 2px #002a39;"><p class="p_Normal"><span style="font-weight: bold; color: #ffffff;">Example 1 showing conditional statements</span></p>
</th>
</tr>
</thead>
<tbody>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:729px; padding:6px; border:solid 2px #002a39;"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">if $(systemtypeId) = null </span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">then</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid; margin: 0px 0px 0px 13px;"><span class="f_CodeExample">RESULTMSG.warning systemtypeId 'no Systype found for' + ' systype [' + $(systype) + ']' + ' and client [' + $(client) + ']';</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">end</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">if $(sysperfgrpId) = null </span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">then</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid; margin: 0px 0px 0px 13px;"><span class="f_CodeExample">RESULTMSG.failure sysperfgrpId 'no Sysperfgrp found for' + ' sysperfgrpNo [' + $(sysperfgrpNo) + ']' + ' and client [' + $(client) + ']';</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample"> &nbsp; &nbsp;/* failure causes rollback transaction */</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">end</span></p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="p_Normal">&nbsp;</p>
<div style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 10px;"><table style="border:none; border-spacing:1px;">
<thead>
<tr style="text-align:left;vertical-align:top;">
<th style="vertical-align:top; width:296px; height:14px; background-color:#0062a2; padding:6px; border:solid 2px #002a39;"><p class="p_Normal"><span style="font-weight: bold; color: #ffffff;">Example 2 showing database statements</span></p>
</th>
</tr>
</thead>
<tbody>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:296px; padding:6px; border:solid 2px #002a39;"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">$(today) = today();</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">/* check if a record exists within the relation table */</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">if not exists AMA_COMPSYSTEM</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample"> &nbsp; &nbsp;where</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample"> &nbsp; &nbsp; &nbsp; &nbsp;COMPONENT_ID = $(componentId) and SYSTEM_ID = $(../systemId)</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample"> &nbsp; &nbsp; &nbsp; &nbsp;and VALIDTO &gt; $(today)</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">then</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample"> &nbsp; &nbsp;$(yesterday) = yesterday();</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample"> &nbsp; &nbsp;/* if the Component is already assigned, set its VALIDTO date */</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample"> &nbsp; &nbsp;update AMA_COMPSYSTEM </span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample"> &nbsp; &nbsp;set </span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample"> &nbsp; &nbsp; &nbsp; &nbsp;VALIDTO = $(yesterday), </span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample"> &nbsp; &nbsp; &nbsp; &nbsp;USERCHG = $(USERCHG), </span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample"> &nbsp; &nbsp; &nbsp; &nbsp;DATCHG = $(DATCHG)</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample"> &nbsp; &nbsp;where </span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample"> &nbsp; &nbsp; &nbsp; &nbsp;COMPONENT_ID = $(componentId)</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample"> &nbsp; &nbsp; &nbsp; &nbsp;and VALIDTO &gt; $(today);</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample"> &nbsp; &nbsp;delete FROM AMA_COMPSYSTEM</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample"> &nbsp; &nbsp;where COMPONENT_ID = $(componentId) and VALIDTO &lt; VALIDFROM;</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample"> &nbsp; &nbsp;/* generate a new id using AMT_HIGHESTKEY */</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample"> &nbsp; &nbsp;$(relationId) = newID('AMA_COMPSYSTEM', 'COMPSYSTEM_ID');</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample"> &nbsp; &nbsp;$(usuMaxDate) = toDate('01.01.2100');</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample"> &nbsp; &nbsp;insert into AMA_COMPSYSTEM</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample"> &nbsp; &nbsp;(COMPSYSTEM_ID, SYSTEM_ID, COMPONENT_ID, VALIDFROM, VALIDTO, CLIENT, USERCRE, DATCRE, USERCHG, DATCHG)</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample"> &nbsp; &nbsp;values ($(relationId), $(../systemId), $(componentId),</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$(today), $(usuMaxDate), $(client), $(USERCRE), $(DATCRE), $(USERCHG), $(DATCHG));</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">end</span></p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="p_Normal">Our last example shows a loop statement.</p>
<div style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 10px;"><table style="border:none; border-spacing:1px;">
<thead>
<tr style="text-align:left;vertical-align:top;">
<th style="vertical-align:top; width:729px; height:14px; background-color:#0062a2; padding:6px; border:solid 2px #002a39;"><p class="p_Normal"><span style="font-weight: bold; color: #ffffff;">Example 3 showing a loop statement</span></p>
</th>
</tr>
</thead>
<tbody>
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:729px; padding:6px; border:solid 2px #002a39;"><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">loop select ITEM_POS, ARTICLE_ID, AMOUNT</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample"> &nbsp; &nbsp; &nbsp; into $(itemPos), $(articleId), $(amount)</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample"> &nbsp; &nbsp; &nbsp; from wl_order_pos </span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample"> &nbsp; &nbsp; &nbsp;where ORDER_NR = $(ORDER_NR)</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">do</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample"> &nbsp; &nbsp;insert into temp_order_pos (order_nr, item_pos, article_id, amount)</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; values ( $(ORDER_NR), $(itemPos), $(articleId), $(amount) );</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample"> &nbsp;</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample"> // &nbsp; RESULTMSG.info 'item: pos = ' + $(itemPos) + ', article = ' + $(articleId) + ', amount = ' + $(amount);</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">end</span></p>
</td>
</tr>
</tbody>
</table>
</div>
<h2 class="p_Heading2"><span class="f_Heading2">Testing the channel</span></h2>
<p class="p_Normal">You may test the <span class="f_Emphasize">Database target channel</span> like every other outbound channel. </p>
<p class="p_Normal">When the channel is configured the user can test its functionality by clicking on the test symbol in the tool bar of the Designer.</p>
<p class="p_Normal">Then a dialog opens showing the events the channel receives or an error message.</p>
<h2 class="p_Heading2"><span class="f_Heading2">See also</span></h2>
<p class="p_Normal">You also may use the channels <a href="database-blob-reader.html" class="topiclink">Database BLOB Reader</a>, <a href="database-reader.html" class="topiclink">Database Reader</a>, <a href="database-source-reader.html" class="topiclink">Database Source Reader</a> and <a href="database-outbound-channel.html" class="topiclink">Database Outbound Channel</a> to access a database resources.</p>

<!--ZOOMSTOP-->


</div> <!-- idcontent -->
</div><!-- hmbox --> 
</body>
</html>
