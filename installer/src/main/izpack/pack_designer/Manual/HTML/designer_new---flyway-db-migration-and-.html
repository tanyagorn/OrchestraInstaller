<!DOCTYPE html>
<html>
<head>
   <title>NEW - Flyway DB Migration and Versioning</title>
   <meta http-equiv="X-UA-Compatible" content="IE=edge" />
   <meta name="viewport" content="width=device-width, user-scalable=yes, initial-scale=1, minimum-scale=1" />
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="content-language" content="en-us" />
   <meta name="description" content="Flyway is a simple but powerful tool that helps you to maintain your Database properly. Main reasons for using flyway are:" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <link id="tabscheme" type="text/css" href="hm_topic.css" rel="stylesheet" />   
<style type="text/css">
/* No header topics */

/* Breadcrumb trail */
p#breadcrumbs {
font-family: Verdana, Tahoma, Helvetica, Sans-Serif;   padding: 2px 0 1px 2px;
   margin: 0;
   font-size: 8pt; 
   color: #999;
   }   
p#breadcrumbs a { color: #999; text-decoration: none;}
p#breadcrumbs a:visited {color: #999;}
p#breadcrumbs a:hover { color: #333; border-bottom: 1px dotted #333; }

/* Search hightlight color */
span.highlight {background-color: #ffff40;}
</style>
<script type="text/javascript">
var hmHeaderTopic = true;

</script> 
<!--[if IE 9]>
<link id="iesvgcss" rel="stylesheet" type="text/css" href="hm_webhelp_svg.css" />
<![endif]-->	
<script src="jquery.js"></script>
<script type="text/javascript" src="jquery.tools.min.js"></script>
<script type="text/javascript" src="jquery.scrollTo-min.js"></script>
<script type="text/javascript"> 
// General topic variables
var tVars = {
   hmHelpPage: "index.html",
   nextP: "installation_windows.html",
   prevP: "installation_db2.html",
   currP: "designer_new---flyway-db-migration-and-.html",
   descr: "Flyway is a simple but powerful tool that helps you to maintain your Database properly. Main reasons for using flyway are:",
   keys: "",
   defP: "installation_database.html",
   mailUrl: "",
   mailUrlQuery: "",
   projectTitle: "Documentation",
   titleP: "NEW - Flyway DB Migration and Versioning",
   mailsubject: "Your feedback: Documentation - NEW - Flyway DB Migration and Versioning",
   sharesubject: "Documentation - NEW - Flyway DB Migration and Versioning",
   simplesubject: "Documentation%20Feedback",
   mailid: "designer_NEW---Flyway-DB-Migration-and-",
   mailpath: "Orchestra Documentation &gt; Installation &gt; Installation Database &gt; NEW - Flyway DB Migration and Versioning /",
   mailbody: "",
   fbtype: false,
   header: true,
   background: "spacer.gif",
   tablesReady: false,
   togglesReady: false,
   webRedirect: true,
   topicTitleBar: true,
   titleBarContent: "topic",
   printFooter: true,
   zoomTip: "Click here to view image in its original size",
   autoPrint: true,
   printButton: "Print",
   printButtonTip: "Print topic"
   }
// Popup configuration
 var hmpBShadow = true;
 var hmPopSmallDim = 500;
 var hmPopKillVideo = true;
 // AutoTOC variables
 var hmatocvars = {
   atoc_show: true,
   atoc_title: "Topic content",
   atoc_tip: "Navigate to:&nbsp;",
   atoc_minHeaders: 3,
   atoc_btntip_off: "No topiv headers on this site",
   atoc_btntip_on: "Show/hide topic menu",
   atoc_toptip: "Navigate to beginning of page",
   atoc_top: "Beginning of page",
   atoc_bg: "#f6f6f6",
   atoc_border: "silver",
   atoc_linkcolor: "#444",
   atoc_linklimit: 45,
   atoc_hovercolor: "#000",
   atoc_hoverbgcolor: "#e0e0e0"
}
// Sortable tables
var sortVars = {
   europeandate: false,
   germanNumbers: false,
   imagePath: "",
   image_up: "arrow-up.gif",
   image_down: "arrow-down.gif",
   image_empty: "arrow-empty.gif",
   image_none: "arrow-none.gif",
   sort_tip: "Click here to sort column",
   umlauts: "false"
   }

</script>


<script type="text/javascript" src="helpman_settings.js"></script>
<script type="text/javascript" src="helpman_topicinit.js"></script>
<script type="text/javascript" src="hmtopic.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "designer_new---flyway-db-migration-and-.html");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body>
<!-- Help & Manual Premium Pack templates by Tim Green, Copyright (c) 2011-2014, All Rights Reserved -->
<!--ZOOMSTOP-->



<ul id="topictabs" class="tabs">
<li id="indextab" class="hmtabs"><a href="#" id="indextablink" class="current"><span>NEW - Flyway DB Migration and Versioning</span></a></li>
</ul>
<div id="hmbox">
<div id="hmheader">
<div id="hmheadercontents">
<p id="breadcrumbs" class="sync-toc">
<b><span class="sync-toc"><a rel="nofollow" class="sync-toc-link" href="index.html?designer_new---flyway-db-migration-and-.html" target="_top">&lt;&lt;&nbsp;Click here for table of contents&nbsp;&gt;&gt;</a>&nbsp;&nbsp;</span></b></p> 
<h1 class="p_Heading1"><span class="f_Heading1">NEW - Flyway DB Migration and Versioning</span></h1>

</div>
<div id="atocIcon" class="navdivs">
<img class="navicon" id="hmAtocLink" src="contents_off.png" alt="No topiv headers on this site" title="No topiv headers on this site" />
<br /><span>Topic content</span>
</div>
</div>
<div id="autoTocWrapper" class="topicmenu"></div>
<div id="idcontent">
<div id="unclicker"></div>
<!--ZOOMRESTART-->
<p class="p_Normal">Flyway is a simple but powerful tool that helps you to maintain your Database properly. Main reasons for using flyway are:</p>
<p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span>Database Schema versioning;</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span>Consistent Database migration;</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span>Easy maintenance of Database;</p><p class="p_Normal">Flyway has a command line tool that provides commands such as:</p>
<p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span>migrate</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span>clean</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span>info</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span>validate</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span>baseline</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span>repair</p><p class="p_Normal">Flyway maintains one table - <span style="font-weight: bold;">schema_version</span> to achieve its tasks. This table will exist with other tables that come with Orchestra.</p>
<p class="p_Normal">For more details please have a look at <a href="https://flywaydb.org" target="_blank" class="weblink">https://flywaydb.org</a></p>
<p class="p_Normal"><span style="font-weight: bold;">Important: Flyway is only usable for databases that are created from the scratch with Flyway. That means you cannot migrate existing databases that</span></p>
<p class="p_Normal"><span style="font-weight: bold;">are created with the SQL Scripts or other tools.</span></p>
<p class="p_Normal">&nbsp;</p>
<h1 class="p_Heading1"><span class="f_Heading1">&nbsp;</span></h1>
<p class="p_Normal">&nbsp;</p>
<h1 class="p_Heading1"><span class="f_Heading1">Orchestra Database Migration</span></h1>
<p class="p_Normal">Please have in mind that you need to create your <span style="font-weight: bold;">user in DB manually.</span> With flyway we do not want to maintain system scripts like in <a href="installation_mysql.html" class="topiclink">MySQL</a>, <a href="installation_mssql.html" class="topiclink">MSSQL</a>, <a href="installation_oracle.html" class="topiclink">Oracle</a> or <a href="installation_db2.html" class="topiclink">DB2</a>, but rather deal only with Schema and, optionally, small set of data (like e.g. adding admin user).</p>
<p class="p_Normal">For migrating and maintaining orchestra Database we have following options:</p>
<p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><a href="designer_new---flyway-db-migration-and-.html#cleanmigrate" class="topiclink">Clean and migrate</a> with flyway - this option is strongly recommended if you are installing Orchestra for the first time;</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><a href="designer_new---flyway-db-migration-and-.html#migrate" class="topiclink">Migrate</a> with flyway - this option is used only in case you already used flyway for Orchestra DB (e.g. with version 4.6.0.0);</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><a href="designer_new---flyway-db-migration-and-.html#baselineandmigrate" class="topiclink">Baseline and migrate </a>with flyway - this option is recommended if you want to keep your old Orchestra Database, but want to make new migrations with flyway;</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span>No flyway - use old installation procedures from <a href="installation_mysql.html" class="topiclink">MySQL</a>, <a href="installation_mssql.html" class="topiclink">MSSQL</a>, <a href="installation_oracle.html" class="topiclink">Oracle</a> or <a href="installation_db2.html" class="topiclink">DB2</a>.</p><h2 class="p_Heading2"><span class="f_Heading2">Configuring flyway</span></h2>
<p class="p_Normal">Following steps are making your flyway ready for use:</p>
<p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span>Edit configuration file <span style="font-weight: bold;">conf/flyway.conf</span>, where you have to set DB connection string, location of the scripts and optionally other parameters (more details: <a href="https://flywaydb.org/documentation/commandline/migrate" target="_blank" class="weblink">https://flywaydb.org/documentation/commandline/migrate</a>)</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span style="font-weight: bold;">SQL Scripts</span> that are by default located in <span style="font-weight: bold;">sql</span> directory. Location of the Scripts can be set in flyway.conf. This is sample flyway.conf:</p><p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid; margin: 0px 0px 0px 23px;"><span class="f_CodeExample">flyway.url=jdbc:mysql://localhost:3306/orctrunk</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid; margin: 0px 0px 0px 23px;"><span class="f_CodeExample">flyway.user=ORCTRUNK </span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid; margin: 0px 0px 0px 23px;"><span class="f_CodeExample">flyway.password=ORCTRUNK </span></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid; margin: 0px 0px 0px 23px;"><span class="f_CodeExample">flyway.locations=filesystem:sql/mysql</span></p>
<p class="p_Normal">&nbsp;</p>
<p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 50px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#10146;</span> <span style="font-weight: bold;">flyway.url</span> - URL of the DB to be used;</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 50px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#10146;</span> <span style="font-weight: bold;">flyway.user</span> - User used to connect to DB;</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 50px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#10146;</span> <span style="font-weight: bold;">flyway.password</span> - Password used to connect to DB;</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 50px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#10146;</span> <span style="font-weight: bold;">flyway.location</span> - Relative paht of the location of SQL Scripts that will be used for migration</p><p style="text-align: left; text-indent: 0px; line-height: 1.80; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 10px;"><span style="font-size:15px; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span style="font-weight: bold;">JDBC driver</span> - your JDBC driver goes to <span style="font-weight: bold;">drivers</span> directory.</p><p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Here you can see typical flyway directory with files and subdirectories:</p>
<p class="p_Normal"><img alt="flywayDirectory" width="410" height="244" style="margin:0;width:410px;height:244px;border:none" src="flywaydirectory.png"/></p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid;"><span class="f_CodeExample">&nbsp;</span></p>
<h2 class="p_Heading2"><a id="cleanmigrate" class="hmanchor"></a><span class="f_Heading2">Clean migrate</span></h2>
<p class="p_Normal">Clean migrate is done from command line tool:</p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid; margin: 0px 0px 0px 10px;"><span class="f_CodeExample">flyway clean migrate</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">All SQL Scripts from configured location will be executed and table <span style="font-weight: bold;">schema_version</span> will be created.</p>
<h2 class="p_Heading2"><a id="migrate" class="hmanchor"></a><span class="f_Heading2">Migrate</span></h2>
<p class="p_Normal">Migration is done from command line tool:</p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid; margin: 0px 0px 0px 10px;"><span class="f_CodeExample">flyway migrate</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">All SQL Scripts that have version number bigger than the current version of your DB Schema (from table <span style="font-weight: bold;">schema_version</span>) will be executed.</p>
<h2 class="p_Heading2"><a id="baselineandmigrate" class="hmanchor"></a><span class="f_Heading2">Baseline and migrate</span></h2>
<p class="p_Normal">In this option you will first have to find your current version of Orchestra DB - that is the version of Orchestra you are using. When you find out which version that is (e.g. V4.5.5.0), please find matching version of SQL Script (for given example that would be V75__V4.5.5.0_upgrade.sql).</p>
<p class="p_Normal">Next you will have to make a baseline for your DB Schema:</p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid; margin: 0px 0px 0px 10px;"><span class="f_CodeExample">flyway baseline -baselineVersion=75 -baselineDescription=&quot;Base version up to orchestra V4.5.5.0&quot;</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">This command will create table <span style="font-weight: bold;">schema_version</span> and set baseline version in it.</p>
<p class="p_Normal">After setting baseline, migration is done also with:</p>
<p class="p_CodeExample" style="page-break-inside: avoid; page-break-after: avoid; margin: 0px 0px 0px 10px;"><span class="f_CodeExample">flyway migrate</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">All SQL Scripts that have version number bigger than the baseline version of your DB Schema will be executed.</p>
<h2 class="p_Heading2"><span class="f_Heading2">No Flyway</span></h2>
<p class="p_Normal">Please refer to <a href="installation_mysql.html" class="topiclink">MySQL</a>, <a href="installation_mssql.html" class="topiclink">MSSQL</a>, <a href="installation_oracle.html" class="topiclink">Oracle</a> or <a href="installation_db2.html" class="topiclink">DB2</a>.</p>

<!--ZOOMSTOP-->


</div> <!-- idcontent -->
</div><!-- hmbox --> 
</body>
</html>
